{% extends "base.html" %}

{% block title %}–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–Ω—è - VibeMe{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card card-custom">
            <div class="card-body p-5 text-center">
                <h2 class="mb-4">üîÆ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–Ω—è</h2>
                <p class="text-muted mb-4">–ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!</p>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è -->
                <div class="mb-5">
                    <a href="{{ url_for('main.prediction') }}" class="btn btn-custom btn-lg">
                        üé≤ –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
                    </a>
                    <p class="text-muted mt-2">
                        –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
                    </p>
                </div>
                
                <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è -->
                {% if prediction %}
                <div class="prediction-card mb-5">
                    <div class="category-badge mb-3">
                        <span class="badge bg-purple">{{ category_name }}</span>
                    </div>
                    
                    <div class="prediction-text mb-4">
                        "{{ prediction.text }}"
                    </div>
                    
                    <div class="prediction-actions mt-4">
                        <button onclick="copyPrediction()" class="btn btn-outline-secondary btn-sm">
                            üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button onclick="sharePrediction()" class="btn btn-outline-primary btn-sm ms-2">
                            üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                        </button>
                    </div>
                </div>
                {% endif %}
                
                <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
                <div class="mb-5">
                    <h5 class="mb-3">üéØ –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h5>
                    <div class="row g-2">
                        {% for key, value in all_categories.items() %}
                        <div class="col-6 col-md-4 col-lg-3">
                            <a href="{{ url_for('main.prediction_by_category', category=key) }}" 
                               class="btn btn-outline-secondary w-100 {% if selected_category == key %}active{% endif %}">
                                {{ value }}
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö -->
                <div class="row text-center">
                    <div class="col-md-4 mb-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5>{{ all_categories|length }}</h5>
                                <p class="text-muted mb-0">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5>‚àû</h5>
                                <p class="text-muted mb-0">–ü–æ–ø—ã—Ç–æ–∫ –≤ –¥–µ–Ω—å</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5>üé≤</h5>
                                <p class="text-muted mb-0">–°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function copyPrediction() {
    const predictionText = document.querySelector('.prediction-text').textContent;
    navigator.clipboard.writeText(predictionText).then(() => {
        alert('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    }).catch(err => {
        console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
    });
}

function sharePrediction() {
    const predictionText = document.querySelector('.prediction-text').textContent;
    const shareText = `–ú–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: ${predictionText} #VibeMe`;
    
    if (navigator.share) {
        navigator.share({
            title: '–ú–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è',
            text: shareText,
            url: window.location.href
        });
    } else {
        navigator.clipboard.writeText(shareText).then(() => {
            alert('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏!');
        }).catch(err => {
            console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
        });
    }
}
</script>
{% endblock %}